<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="jp.co.senshinsoft.persistence.WorkReportMonthlyMapper">
	<select id="findEmployeeWorkRecordMonthly"
		resultType="jp.co.senshinsoft.domain.WorkReportMonthly">
		SELECT
		teiji
		,year
		,month
		,kd_jkn_kei
		,jkngi_kei
		,pj_mei
		,tokkijiko
		,auth_flg
		FROM
		work_report_monthly
		WHERE
		user_id=#{userId}
		AND
		year=#{year}
		AND
		month=#{month}
	</select>
	
	<insert id="registWorkReportMonthly">
		INSERT INTO
		work_report_monthly (user_id, year, month, teiji, kd_jkn_kei, jkngi_kei,
		pj_mei, tokkijiko, auth_flg ,ins_user ,ins_date,
		upd_user, upd_date)
		 VALUES (#{userId}, #{year}, #{month}, #{teiji}, #{kdJknKei}, #{jkngiKei}, #{pjMei}, #{tokkijiko}
		 , #{authFlg}, #{userId}, CURRENT_TIMESTAMP, #{userId}, CURRENT_TIMESTAMP
		)
	</insert>
	
	<update id="updateWorkReportMonthly">
	UPDATE
		work_report_monthly
	SET
		kd_jkn_kei=#{kdJknKei}
		,jkngi_kei=#{jkngiKei}
		,pj_mei=#{pjMei}
		,tokkijiko=#{tokkijiko}
		,upd_user=#{updUser}
		,upd_date=CURRENT_TIMESTAMP
	WHERE
		user_id=#{userId}
		AND year=#{year}
		AND month=#{month}
	</update>
	<update id="changeAuthFlg">
	UPDATE 
		work_report_monthly 
	SET 
		auth_flg = true, 
		upd_user=#{userId},
		upd_date=CURRENT_TIMESTAMP  
	WHERE 
		user_id=#{userId}
		 AND year=#{year}
		 AND month=#{month}
	</update>
	
</mapper>